<Blog>

<date>28,July,2004</date>
<post>

     
        T he Microsoft Windows 2000 Active Directory is the central repository in which all objects in an enterprise and their respective attributes are stored. It is a hierarchical, multi-master enabled database, capable of storing millions of objects. Because it is multi-master, changes to the database can be processed at any given domain controller (DC) in the enterprise regardless of whether the DC is connected or disconnected from the network. 
</post>

<date>27,July,2004</date>
<post>

     
        In Windows 2000 Server, system state data comprises the registry, COM+ Class Registration database, system startup files, and the Certificate Services database. Restoring the Registry - If you use Backup to restore lost data to the registry, all system state data is replaced.  If error in registry and coputer ceases to function, you can restore registry to its state when you last successfully started your computer, by selecting Last Known Good Configuration. However, since you have already started the computer, logged on.  When you run setup.exe with DisasterRecovery option, E2k restores executables files and system settings without disturbing existing Active Directory information for the system, such as mailbox and public stores. Setup in disaster recovery mode installs E2k without resetting server config to default, but leaves server in last config. Setup /disasterrecovery reconfigures local server, with program files, registry settings and database paths.  Domainprep run once per domain to create public folder proxy container and set permissions within domain. Do not need to run Domain Prep in doain where you install E2k and in call domain containing recipient objects, such as mailboxes or DLs.  Creating storage group for each database on servers 1 and 2 you would be able to restore each database simultaneously. Circular logging is diabled by default, so you would be able to restore database on server 1 and server 2 to state existed 1 minute prior to failurewould require presence of transactional logs. Creating storage group for all databases on server 3 would be able to restore each database simultaneously.  Databases restores to different server require new database GUIDS. You need to select "Database can be overwritten by a restore" for all databases that you intend to recoever. This causes IS to patch databases and assign new database GUIDs  When performing backup and restore, you receive 1018,1019 or 1022: Database is damaged error. 1010ESE reporting hard faults, whcih can be hardware faults. Means online backup cannot complete because database damaged.When restoring database and logs, sepcify working directory for backup and imp to specify folder different from production log file location. During hard receovery, older logs from temp dir to databases before more recent logs from prod loc are replayed. Allows you to receover even those items not included in backup.    
     
    
</post>

<date>27,July,2004</date>
<post>

     
       Exchange&nbsp;5.5 and Earlier  Earlier versions of Exchange used directory databases. The directory database contains configuration information as well as distribution lists, custom recipients, and some mailbox information (the directory stores only the mailbox directory object; the Information Store database stores the actual mailbox content). The directory also stores public folder directory objects, which are by default hidden directory objects in the Recipients container.   Exchange&nbsp;2000 and Later  Exchange&nbsp;2000 and Exchange Server&nbsp;2003 do not have their own directory. Instead, both Exchange&nbsp;2000 and Exchange&nbsp;2003 use Active Directory. The actual mailbox and public folder information is still stored in the Exchange store.   Communicating Between Versions  Coexistence and migration can be a challenge because Exchange&nbsp;5.5:   Predates Active Directory, and   Cannot communicate with servers running Exchange&nbsp;2000 and later as easily as it can with other servers running Exchange&nbsp;5.5.   So, the first server running Exchange&nbsp;2000 or Exchange&nbsp;2003 that joins each Exchange&nbsp;5.5 site creates and runs a special database called a Site Replication Service (SRS).   Site Replication Service  SRS is essentially an Exchange&nbsp;5.5–style directory that runs on Exchange&nbsp;2000 or later servers and really gives Exchange&nbsp;5.5 a directory "to talk to" on the Exchange&nbsp;2000 or later side. SRS does not have some of the limitations that the Exchange&nbsp;5.5 directory has, so it plays a crucial part in Exchange&nbsp;5.5 and Exchange&nbsp;2000 and later coexistence and migration situations. Essentially, configuration changes to the Exchange organization that are made in Active Directory replicate from the Active Directory:   Into the SRS database though the ADC connection agreement, and then,   From the SRS into the Exchange&nbsp;5.5 directory through the standard Exchange&nbsp;5.5 directory replication process.    Active Directory Connector  When you migrate, you need some way to move your directory objects from the Exchange&nbsp;5.5 directory into Active Directory. Active Directory Connector (ADC) is the solution. The ADC is what will synchronize the Exchange&nbsp;5.5 directory with Active Directory. This is done through the use of Connection Agreements. There are three types of Connection Agreements that the ADC for Exchange&nbsp;2000 and later supports:   Recipient Connection Agreement (RCA), responsible for replication of mailboxes, distribution lists, and Custom Recipient directory objects from the Exchange&nbsp;5.5 directory to Active Directory and back. Again, this replicates directory objects only, so this does not have anything to do with the moving of actual mailbox content.   Public Folder Connection Agreement (PFCA), responsible for replication of public folder directory objects between Exchange&nbsp;5.5 and Active Directory. Public folder directory objects are used when sending an e-mail message to a public folder and when administering a folder, especially on Exchange&nbsp;5.5. So again, this is not for replication of actual public folder content between servers.   Configuration Connection Agreement (Config_CA), responsible for replication of organization and site configuration information such as servers and connectors.   Note: Always use the most recent version of the Exchange ADC and not a Microsoft Windows® ADC, which was released on the Windows&nbsp;2000 CD, because the Windows&nbsp;2000 ADC is not capable of doing many things that the Exchange&nbsp;2000 ADC can do and it has not been updated since its release.  &nbsp; 
     
    
</post>

<date>05,August,2004</date>
<post>

     
        In Microsoft® Windows® 2000 Server, system state data comprises the registry, COM+ Class Registration database, system startup files, and the Certificate Services database. Restoring the Registry - If you use Backup to restore lost data to the registry, all system state data is replaced.  The registry is not contained within the SYSVOL directory, so this would not help repair the registry.  When you back up the system state data, a copy of your registry files is also saved in the folder %SystemRoot%\Repair\Regback. If your registry files become corrupted or are accidentally erased, you can use these files to repair the registry without performing a full restore of the system state data. This method of repairing the registry is only recommended for advanced users.   If there is an error in your registry and your computer ceases to function properly, you can restore the registry to its state when you last successfully started your computer. To do this, select Last Known Good Configuration. However, since you have already started the computer, and successfully logged on, the last known good configuration would be the configuration you are now running.  When you run Setup.exe with the /DisasterRecovery option, Exchange 2000 restores executable files and system settings without disturbing the existing Active Directory information for the system, such as mailbox and public stores. Setup in disaster recovery mode installs Exchange 2000 without resetting the server’s configuration to defaults, but instead, leaves the server in its last configuration. Setup /DisasterRecovery will reconfigure the local server, including program files, registry settings, and database paths.  DomainPrep is run once per domain to create the public folder proxy container and set permissions within the domain. You do not need to run DomainPrep in a domain until you are ready to install Exchange 2000. DomainPrep must be run in all domains where you install Exchange 2000 and in all domains that contain recipient objects, such as mailboxes or distribution lists.  If you install Exchange 2000 without specifying /DisasterRecovery then existing Active Directory information for the system, such as mailbox and public stores will be lost. These answers are therefore not the best solutions.  You are required to prevent unauthorized users from view email messages, usernames and password. You can achieve by encrypting email messages, usernames and passwords. By using a secure web server all HTTP traffic will be encrypted. In order to use a secure web server you need to request and install a certificate. By using a secure channel all IMAP traffic will be encrypted. In order to use a secure channel you need to request and install a certificate.  If Basic Authentication is enabled (the default), clients are not forced to encrypt the user name or password. If an intruder can watch the communication between a client and the server, this person can get access to users' account information. It is advisable to disable the Basic Authentication method, but alternatively, you may enforce the encryption of the communication channel. The option to disable Basic Authentication would prevent the username and password from being sent in plain text, but would not stop email messages being intercepted and read, and so is not the best solution   You can use MIME Base64 encoding (which replaced the legacy Unix-to-Unix encoding method [UUENCODE]) and plain text, to encode data using Internet standard transfer formats. Encoding is used to place data into a stream of bits for external storage or transmission, not to protect and prevent access to the contents.  All access to mailbox and public folder resources is validated, although you have the option to allow anonymous access to public folders. If the users used Anonymous (The Anonymous account corresponds to the Anonymous Logon system account of Windows 2000) then they would not be able to access their own mailboxes. Since all users are accessing mailboxes they will be authenticated using their own logon information.  By creating a storage group for each database on servers 1 and 2 you would be able to restore each database simultaneously. Circular logging is disabled by default, so therefore you would be able to restore the databases on server 1 and server 2 to the state that existed 1 minute prior to the failure would require the presence of transaction logs. By creating a storage group for all databases on server 3 you would be able to restore each database simultaneously.  Circular logging basically means automatically deleting transaction log files and their entries. Circular logging prevents duplicate consumption of disk space, but it is not compatible with fault-tolerant configurations and several online backup types, which rely on the existence of transaction logs. In order to restore the databases on server 1 and server 2 to the state that existed 1 minute prior to the failure would require the presence of transaction logs.  All databases within a storage group share the same set of log files, so transaction logs are deleted only after all databases have been backed up. This is one reason you should configure backup operations for entire storage groups. By creating a storage group for each database on server 3 you would not be able to restore each database simultaneously.  Circular logging basically means automatically deleting transaction log files and their entries. Circular logging prevents duplicate consumption of disk space, but it is not compatible with fault-tolerant configurations and several online backup types, which rely on the existence of transaction logs. Although the question does not state that up-to-the-minute recovery should be possible it is not recommended that you enable circular logging for storage groups that hold business-relevant data. With full-text indexing, every word in a store is indexed, making faster search and retrieval possible without requiring special mail clients. This is not required and unnecessary.  Backups of system state information, which covers Active Directory, Registry, IIS metabase, and data from other system components, such as Certificate Services. Therefore you need to restore the system state data to restore the metabase to a point prior to Stefan's changes.  The Inetpub directory is the root directory housing the web root directory, scripts, samples, nntpfile and other folders that contain data. Configuration however is stored in the IIS metabase, which resides on the local hard disk of each IIS server in a file named METABASE.BIN, which is located in the \Winnt\System32\Inetsrv directory, by default. Replacing the contents of Inetpub would therefore not help correct changes made.  Reinstalling IIS will not correct the changes that have been made. The result of a reinstall will either be to replace the metabase contents with a default copy or retain the current incorrect settings.  Databases restored to a different server require new database GUIDs. You need to select the 'This Database Can Be Overwritten By A Restore' check box for all those databases that you intend to recover. This causes the Information Store to patch the databases and assign new database GUIDs.  ISINTEG -patch is not a valid switch. Valid switches include -s (ServerName), -fix (check and fix), -verbose (report verbosely), -l (log file name), -t (reference database location), -test (testname,...) & -dump (verbose dump of store data).  Online backups are aware of the Exchange Server databases and their transaction log files. They guarantee that entire stores are covered even if only transaction log files are written to tape. The restore process will restore any backups including transaction logs that are required. New transactions will be written to wherever the new transaction log files reside. Their location is not relevant to the restore process.  Circular logging basically means automatically deleting transaction log files and their entries. However the restore process will restore any backups including transaction logs that are required. Future transaction logs will be deleted automatically, but this should not affect previous backup and restore operations.  When performing backup and restore, you receive an Event ID 1018, 1019, or 1022: Database is damaged error message. The error seen was 1010ESE reporting hard faults, which can be equated to hardware faults. This means that online backup cannot complete because the database is damaged. Check the hardware for errors and complete a restore of this database as soon as possible. When restoring databases and transaction log files, specify a working directory for the Backup utility. It is important to specify a folder different from the production log file location. During hard recovery, older logs are applied from the temporary directory to the databases before the more recent logs from the production location are replayed. This allows you to recover even those items that have not been included in the backup. Therefore you should ensure that the existing transaction logs are not overwritten.  If all your recent backups cannot be used, you will have to fix corruption using ESEUTIL.EXE with the /p switch. After running ESEUTIL.EXE, you must check the databases at the Information Store level using ISINTEG.EXE. Since current backups are available, you should use these. This is not the optimal solution   You can use ESEUTIL/g to check database integrity. This is a read-only utility that does not make changes to the database  Removing the existing transaction logs will prevent you from recovering those items that have not been included in the backup.  If you discover a corrupted database, you may attempt to fix the problem. If all your recent backups cannot be used, you will have to fix corruption using ESEUTIL.EXE with the /p switch. It is important to note that the repair is performed at the level of the ESE, which is below the Information Store. While corrupted pages are fixed and purged, the database is returned to a consistent state, but this does not mean that it still contains all the data that the Information Store needs to operate accurately. Hence, after running ESEUTIL.EXE, you must check the databases at the Information Store level using ISINTEG.EXE. The Information Store Integrity utility (ISINTEG) can find and eliminate database errors and problems in high-level data structures. To fix problems, you must specify the -fix option at the command line.   In a soft recovery, a database starts normally and the storage group is initialized. If the database is inconsistent — that is, it was not shut down properly — the ESE replays transactions from the checkpoint through to the log file, Edb.log. When it encounters a lost database, it reports that the databases are no longer consistent and ceases the soft recovery. To get around this problem, the administrator can run ESEUTIL/R. R stands for soft recovery and causes the server to resume the soft recovery. However, since the transaction log files were damaged not the database files this option would not help. The soft recovery process would have run though as soon as the server was started after the power failure, but this has not helped, (so causing the process to rerun would still not help).  If you experience Information Store problems, you can use ESEUTIL.EXE with the /g switch to verify database integrity. If all your recent backups cannot be used, you will have to fix corruption using ESEUTIL.EXE with the /p switch.  ISINTEG -patch is not a valid switch. Valid switches include -s (ServerName), -fix (check and fix), -verbose (report verbosely), -l (log file name), -t (reference database location), -test (testname,...) &amp; -dump (verbose dump of store data).  Following a successful restore of databases to a recovery server outside the production forest, you need to reconnect the mailboxes that you are interested in to newly created user accounts. In the scenario presented the Exchange Server exists undamaged. However, you would need to create new user accounts in active directory with which you could link mailboxes from the Exchange database files. For numerous mailboxes, on the other hand, use the Mailbox Reconnect utility to generate an .ldf import file, and then use LDIFDE to create the required user accounts in the recovery forest. Next, grant your account Receive As and Send As permissions on the production and recovery stores to open all mailboxes using your account, and then use the Exchange Mailbox Merge Wizard to play back the data from the recovery server to the production systems.  When you run Setup.exe with the /DisasterRecovery option, Exchange 2000 restores executable files and system settings without disturbing the existing Active Directory information for the system. Since server 1, (the only domain controller) fails and a new forest has been created, no Active Directory information for the Exchange 2000 system currently exists.   Even by reinstalling Exchange 2000 and configuring the installation to use the existing database files, the user accounts will not exist - since this information is stored within Active Directory and a new forest has been created.   By joining Exchange 2000 to the new domain user accounts will not exist - since this information is stored within Active Directory and a new forest has been created.   The desired result of a disaster recovery is a 1:1 copy of the original server. Consequently, the hardware configuration of the recovery server should match the configuration of the original machine. Reinstall the operating system. Use the same version of Windows 2000 Server that was previously installed, specify the original system drives, directories, and the old server name. It is vital that you install the same Windows 2000 components that were previously installed. The only difference is that the reinstalled server is a member of a workgroup instead of the production domain. Databases restored to a different server require new database GUIDs. You need to select the 'This Database Can Be Overwritten By A Restore' check box for all those databases that you intend to recover. This causes the Information Store to patch the databases and assign new database GUIDs.  If you want to perform database recovery operations while the original production server is available and users are connected to their mailboxes, you must install Exchange 2000 Server in a different forest.  When you run Setup.exe with the /DisasterRecovery option, Exchange 2000 restores executable files and system settings without disturbing the existing Active Directory information for the system, such as mailbox and public stores. In a new forest (as in the question) no Active Directory information for the system exists, so this answer is not applicable. ISINTEG -patch is not a valid switch. Valid switches include -s (ServerName), -fix (check and fix), -verbose (report verbosely), -l (log file name), -t (reference database location), -test (testname,...) &amp; -dump (verbose dump of store data).  
     
    
</post>

<date>04,August,2004</date>
<post>

     
       What is Active Directory ?    Directory Service which  Organize ,  Manage  and  Control  Resources  Centralized Management  Single point of Administration  Full Access to directory resources by Single Logon    Active Directory Objects   - represents network resources, users, groups, computers, printers, servers, domains, sites......   Active Directory Schema   - contains definitions of all objects, such as printers, users, computers ..... - only one schema for entire forest -  Dynamically Available  -  Dynamically Updateable   -  Protected by DACLs    Lightweight Directory Access Protocol (LDAP)   - LDAP is protocol used to  query  and  update  Active Directory - provides way to communicate with AD specifying Unique Naming Paths for each object - Naming path :  Distinguished names  &  Relative Distinguished names   - DN identifies domain and where object is located e.g. CN=Kamol Sagwan,OU=PSS,DC=exchange,DC=MS - RDN is portion of LDAP DN that uniquely identifies the object in container e.g. Kamol Sagwan   Logical Structure   - Domains - Organizational Units - Trees and Forests - Global Catalog   Domains  - Is a  Security Boundary  Domain administrator can administer only within the domain, unless explicitly granted administration rights in other domains - Is a  Unit of Replication  DCs in a domain participate in replication and contain a complete copy of directory info for their domain   Organizational Units  - to  Group Objects into Logical Hierarchy  within a Domain -  Delegate Administrative Control  over Objects within OU by assigning specific permissions to Users and Groups   Trees and Forests  - First W2k Domain you create is the  Root Domain  - Tree is a hierarchical arrangement of W2k Domains that  Share Contiguous Namespace  - Every child domain has Two-way Transitive Trust Relationship with Parent Domain - Two-way Transitive Trust are default between W2k Domains - Trees linked by Trust Relationships form a Forest   Forests  - Is one or more Trees. Trees in a forest  do not share  contiguous namespace - Share a Common Schema and Global Catalog - Every Tree Root Domain has transitive trust relationship with Forest Root Domain - each Tree in a Forest has its own Unique Namespace   Global Catalog  - Contains subset of attributes of all Active Directory Objects - Find AD info in Entire Forest, regardless of location of Data - use Universal Group Membership info to log on to network - GC Server is a DC that stores a copy of queries and processes them to GC - First DC automatically becomes GC Server   Physical Structure  - Domain Controllers - Sites - to Configure and Manage your Network Traffic - defines where and when Replication and Logon Traffic occur   Domain Controllers  - Stores Replica of AD - Participates in AD replication - Performs Single Master Operation Roles in Domain - AD uses Multi-master Replication Model - Each DC stores writeable copy of AD database for its domain and manages changes and updates to its copy of directory database   Single Master Operations  - assigned to specific DCs to avoid potential conflicts - Operations Master is Single Master Operations Role   Sites  - is a Set of one or more IP Subnets connected using High-speed link - Optimize replication traffic - Enable users to logon to DC using reliable, high-speed connection     
     
    
</post>


</Blog>